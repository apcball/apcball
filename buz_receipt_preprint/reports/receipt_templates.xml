<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="report_receipt_preprint_document">
        <t t-call="web.basic_layout">
            <div class="page" style="padding: 0; margin: 0; width: 215.9mm; height: 279.4mm; position: relative;">
                <style>
                    @media print {
                        @page {
                            size: letter;
                            margin: 0;
                        }
                        body {
                            margin: 0;
                            padding: 0;
                        }
                        .page {
                            width: 215.9mm;
                            height: 279.4mm;
                            margin: 0;
                            padding: 0;
                            overflow: hidden;
                        }
                    }
                    @media screen {
                        .page {
                            background: white;
                            display: block;
                            margin: 0 auto;
                            box-shadow: 0 0 0.5cm rgba(0,0,0,0.5);
                        }
                    }
                </style>

                <!-- Content -->
                <div style="position: relative; z-index: 1; width: 215.9mm; height: 279.4mm;">
                    <!-- Customer Info Section -->
                    <div style="position: absolute; top: 80mm; left: 25mm; width: 100mm;">
                        <div t-field="o.partner_id.name" style="margin-bottom: 3mm; font-size: 14px;"/>
                        <div t-field="o.partner_id.street" style="margin-bottom: 2mm; font-size: 14px;"/>
                        <div t-field="o.partner_id.street2" style="margin-bottom: 2mm; font-size: 14px;"/>
                        <div style="font-size: 14px;">
                            <t t-if="o.partner_id.city" t-esc="o.partner_id.city"/>
                            <t t-if="o.partner_id.state_id" t-esc="o.partner_id.state_id.name"/>
                            <t t-if="o.partner_id.zip" t-esc="o.partner_id.zip"/>
                        </div>
                    </div>

                    <!-- Receipt Number -->
                    <div style="position: absolute; top: 55mm; right: 30mm; text-align: right; font-size: 14px;">
                        <span t-field="o.name"/>
                    </div>

                    <!-- Date -->
                    <div style="position: absolute; top: 65mm; right: 30mm; text-align: right; font-size: 14px;">
                        <span t-field="o.date" t-options='{"format": "dd/MM/yyyy"}'/>
                    </div>

                    <!-- Description -->
                    <div style="position: absolute; top: 110mm; left: 25mm; width: 110mm; font-size: 14px;">
                        <span t-field="o.ref"/>
                    </div>

                    <!-- Amount -->
                    <div style="position: absolute; top: 110mm; right: 30mm; text-align: right; font-size: 14px;">
                        <span t-field="o.amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                    </div>

                    <!-- Amount in Words -->
                    <div style="position: absolute; top: 130mm; left: 25mm; width: 170mm; font-size: 14px;">
                        <span t-esc="o.currency_id.amount_to_text(o.amount)"/>
                    </div>

                    <!-- Signatures -->
                    <div style="position: absolute; bottom: 45mm; width: 215.9mm;">
                        <div style="margin: 0 25mm; display: flex; justify-content: space-between;">
                            <div style="text-align: center; width: 45%;">
                                <div>____________________</div>
                                <div style="margin-top: 2mm; font-size: 14px;">ผู้รับเงิน / Received By</div>
                            </div>
                            <div style="text-align: center; width: 45%;">
                                <div>____________________</div>
                                <div style="margin-top: 2mm; font-size: 14px;">ผู้จ่ายเงิน / Paid By</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="report_receipt_preprint">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="buz_receipt_preprint.report_receipt_preprint_document"/>
            </t>
        </t>
    </template>

    <!-- Report Action -->
    <record id="action_report_receipt_preprint" model="ir.actions.report">
        <field name="name">Receipt Preprint</field>
        <field name="model">account.payment</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">buz_receipt_preprint.report_receipt_preprint</field>
        <field name="report_file">buz_receipt_preprint.report_receipt_preprint</field>
        <field name="print_report_name">'Receipt - %s' % object.name</field>
        <field name="binding_model_id" ref="account.model_account_payment"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="buz_receipt_preprint.paperformat_receipt"/>
    </record>
</odoo>